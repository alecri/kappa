# From Ahmed Hassan <ahmed@cs.queensu.ca>data2= read.csv('data/15.csv',header=T)
require(rms)
log.n <- c(0L, 1L, 2L, 0L, 0L, 3L, 12L, 0L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 2L, 12L, 4L, 10L, 0L, 0L, 0L, 0L, 3L, 0L, 0L, 0L, 
28L, 0L, 0L, 0L, 0L, 3L, 0L, 2L, 0L, 0L, 0L, 1L, 0L, 7L, 0L, 
0L, 0L, 1L, 8L, 4L, 0L, 15L, 5L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 9L, 0L, 0L, 1L, 0L, 0L, 10L, 0L, 0L, 0L, 0L, 
0L, 0L, 2L, 0L, 0L, 0L, 20L, 0L, 33L, 0L, 0L, 1L, 0L, 0L, 37L, 
6L, 3L, 0L, 0L, 0L, 0L, 0L, 0L, 13L, 6L, 0L, 0L, 0L, 0L, 139L, 
1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 50L, 0L, 9L, 0L, 0L, 
0L, 3L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 4L, 0L, 0L, 0L, 
0L, 5L, 0L, 0L, 0L, 0L, 0L, 31L, 5L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 9L, 8L, 0L, 0L, 0L, 0L, 0L, 0L, 3L, 0L, 0L, 0L, 0L, 1L, 10L, 
0L, 0L, 4L, 0L, 0L, 0L, 0L, 0L, 8L, 88L, 5L, 0L, 0L, 1L, 92L, 
0L, 0L, 0L, 0L, 58L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 8L, 0L, 1L, 
1L, 0L, 0L, 0L, 1L, 0L, 20L, 7L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
7L, 0L, 0L, 65L, 0L, 0L, 0L, 0L, 5L, 0L, 0L, 0L, 0L, 0L, 0L, 
1L, 0L, 0L, 0L, 18L, 0L, 0L, 1L, 0L, 18L, 2L, 0L, 0L, 1L, 0L, 
1L, 0L, 0L, 0L, 0L, 0L, 7L, 0L, 0L, 0L, 2L, 0L, 0L, 0L, 4L, 0L, 
0L, 0L, 11L, 0L, 0L, 0L, 0L, 0L, 9L, 0L, 0L, 0L, 0L, 7L, 0L, 
0L, 1L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 1L, 2L, 1L, 
4L, 0L, 0L, 2L, 0L, 0L, 0L, 13L, 18L, 0L, 0L, 0L, 0L, 0L, 1L, 
0L, 2L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 1L, 0L, 8L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 
0L, 0L, 0L, 2L, 0L, 3L, 0L, 0L, 13L, 5L, 0L, 0L, 0L, 0L, 0L, 
0L, 5L, 0L, 0L, 0L, 42L, 0L, 0L, 5L, 0L, 16L, 0L, 0L, 24L, 0L, 
11L, 0L, 0L, 0L, 0L, 15L, 0L)
bug <- c(0L, 1L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 1L, 0L, 
0L, 0L, 2L, 3L, 0L, 6L, 0L, 2L, 2L, 0L, 15L, 0L, 0L, 1L, 10L, 
0L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 8L, 0L, 0L, 0L, 
3L, 0L, 0L, 0L, 2L, 5L, 0L, 1L, 0L, 7L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 5L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 3L, 
0L, 1L, 0L, 0L, 31L, 0L, 0L, 0L, 0L, 1L, 8L, 1L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 10L, 5L, 5L, 0L, 0L, 1L, 22L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 11L, 0L, 2L, 0L, 2L, 0L, 4L, 0L, 0L, 
0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 0L, 1L, 0L, 0L, 
0L, 0L, 0L, 5L, 6L, 0L, 4L, 0L, 0L, 0L, 0L, 0L, 3L, 1L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 
0L, 1L, 0L, 1L, 36L, 2L, 0L, 0L, 0L, 22L, 0L, 0L, 0L, 0L, 0L, 
1L, 0L, 13L, 0L, 0L, 0L, 0L, 3L, 0L, 3L, 1L, 1L, 1L, 0L, 2L, 
0L, 10L, 4L, 0L, 0L, 3L, 0L, 1L, 1L, 0L, 0L, 2L, 0L, 19L, 0L, 
0L, 0L, 0L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 5L, 9L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 3L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 12L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 18L, 0L, 7L, 0L, 0L, 0L, 1L, 0L, 
0L, 0L, 10L, 0L, 0L, 0L, 0L, 1L, 0L, 9L, 2L, 0L, 0L, 0L, 0L, 
1L, 0L, 0L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 
0L, 3L, 7L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 5L, 2L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 3L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 
2L, 0L, 0L, 0L, 9L, 0L, 0L, 0L, 1L, 0L, 2L, 0L, 1L, 0L, 0L, 0L, 
2L, 0L, 15L, 0L, 0L, 5L, 0L, 3L, 5L, 0L, 0L, 2L, 14L, 0L)
pre <- c(0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 
2L, 5L, 0L, 2L, 0L, 3L, 0L, 0L, 5L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 
0L, 1L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 4L, 
0L, 2L, 1L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, 0L, 0L, 3L, 0L, 
0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 
0L, 5L, 0L, 0L, 1L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
2L, 4L, 0L, 0L, 0L, 0L, 6L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 6L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 0L, 0L, 
0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 9L, 2L, 0L, 
1L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 
1L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 14L, 
0L, 0L, 0L, 0L, 9L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 2L, 3L, 0L, 0L, 2L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 12L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 1L, 
0L, 2L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 
2L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 3L, 0L, 3L, 1L, 0L, 0L, 0L, 1L, 
3L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 3L, 0L, 0L, 1L, 7L, 0L, 0L, 1L, 1L, 0L, 1L, 
0L, 0L, 0L, 0L, 0L, 2L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 
0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 7L, 0L, 0L, 3L, 0L, 0L, 1L, 
0L, 0L, 0L, 2L, 0L)
loc <- c(18L, 51L, 219L, 23L, 12L, 49L, 474L, 164L, 11L, 106L, 73L, 
45L, 79L, 8L, 32L, 40L, 571L, 186L, 780L, 5L, 231L, 148L, 18L, 
592L, 49L, 59L, 154L, 903L, 3L, 72L, 246L, 79L, 245L, 26L, 458L, 
42L, 88L, 132L, 179L, 118L, 2444L, 38L, 20L, 153L, 41L, 227L, 
224L, 56L, 622L, 308L, 27L, 142L, 91L, 60L, 31L, 73L, 72L, 95L, 
222L, 219L, 2L, 681L, 68L, 13L, 31L, 1L, 227L, 188L, 13L, 79L, 
14L, 79L, 11L, 3L, 135L, 183L, 69L, 132L, 956L, 15L, 1529L, 82L, 
249L, 68L, 176L, 146L, 898L, 667L, 90L, 26L, 27L, 84L, 68L, 14L, 
158L, 383L, 852L, 42L, 162L, 11L, 49L, 1638L, 14L, 56L, 11L, 
47L, 19L, 48L, 83L, 33L, 23L, 31L, 2434L, 23L, 101L, 38L, 6L, 
78L, 128L, 104L, 5L, 368L, 34L, 24L, 128L, 6L, 57L, 51L, 212L, 
317L, 52L, 82L, 70L, 19L, 118L, 86L, 35L, 41L, 15L, 76L, 1300L, 
531L, 9L, 107L, 88L, 106L, 7L, 32L, 17L, 223L, 148L, 65L, 3L, 
47L, 21L, 61L, 38L, 122L, 17L, 27L, 5L, 25L, 32L, 110L, 92L, 
19L, 92L, 11L, 10L, 84L, 35L, 70L, 96L, 3493L, 290L, 32L, 12L, 
173L, 1789L, 8L, 20L, 71L, 335L, 430L, 38L, 122L, 387L, 56L, 
3L, 27L, 55L, 214L, 22L, 89L, 351L, 156L, 78L, 35L, 356L, 104L, 
549L, 508L, 21L, 131L, 340L, 139L, 64L, 154L, 24L, 294L, 99L, 
13L, 2290L, 140L, 140L, 6L, 32L, 30L, 222L, 35L, 96L, 227L, 81L, 
128L, 290L, 3L, 68L, 490L, 872L, 117L, 12L, 229L, 23L, 702L, 
62L, 125L, 199L, 368L, 83L, 91L, 94L, 39L, 45L, 21L, 31L, 347L, 
3L, 83L, 29L, 312L, 346L, 471L, 30L, 202L, 69L, 48L, 30L, 318L, 
23L, 74L, 94L, 123L, 19L, 970L, 87L, 82L, 454L, 41L, 334L, 6L, 
99L, 557L, 3L, 25L, 20L, 52L, 395L, 119L, 14L, 15L, 408L, 10L, 
366L, 120L, 74L, 195L, 68L, 1046L, 48L, 40L, 127L, 89L, 50L, 
223L, 1132L, 80L, 189L, 7L, 105L, 5L, 10L, 263L, 192L, 714L, 
35L, 24L, 96L, 48L, 101L, 374L, 9L, 125L, 166L, 47L, 284L, 75L, 
289L, 218L, 202L, 178L, 4L, 221L, 88L, 10L, 713L, 82L, 333L, 
30L, 288L, 55L, 50L, 23L, 225L, 97L, 5L, 27L, 63L, 363L, 556L, 
3L, 190L, 489L, 378L, 78L, 61L, 60L, 28L, 155L, 253L, 72L, 39L, 
23L, 49L, 224L, 6L, 20L, 151L, 65L, 906L, 16L, 81L, 337L, 65L, 
759L, 403L, 29L, 152L, 84L, 785L, 23L)
logadd <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0.083333336, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.26666668, 0, 0, 0, 0, 0, 0.875, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.083333336, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0.4, 0.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.27586207, 
0, 0, 0, 0, 1.117647, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0.25, 0, 0, 0, 0, 0, 0, 0, 0)
cochange <-
c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0.083333336, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.083333336, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0.3, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.03448276, 
0, 0, 0, 0, 0.11764706, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0)


table(pre)
# x <- rcs(pre,3)  # will not work
x <- rcs(pre,4)


f = orm( bug ~ rcs(log(1+log.n), 3))
f$stats['Model L.R.']
f = orm( bug ~ rcs(log.n,3))
f$stats['Model L.R.']

f1a <- lrm(bug ~ rcs(loc,3) + logadd + cochange, eps=.001, maxit=20)
f1b = orm( bug ~ rcs(loc,3)+logadd+cochange, eps=.001, maxit=20)
f3 = orm( bug ~ rcs(loc,4)+logadd+cochange, maxit=15)
f4 = orm( bug ~ rcs(loc,3)+logadd)
f5 = orm( bug ~ rcs(loc,3)+cochange)
f6 = orm( bug ~ pol(loc,2)+logadd+cochange)
f7 = orm( bug ~ pol(pre,2)+logadd+cochange, maxit=15)
